DROP DATABASE IF EXISTS CallaoPets_2;
CREATE DATABASE CallaoPets_2;
USE CallaoPets_2;

Create table ESTADO(
	CODESTADO boolean primary KEY,
    NOMBREESTADO varchar(20)
);

CREATE TABLE CLIENTE (
  IDCLIENTE INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  NOMBRES VARCHAR(30) NOT NULL,
  APELLIDOS VARCHAR(30) NOT NULL,
  DNI VARCHAR(8) NOT NULL,
  TELEFONO VARCHAR(11) NOT NULL,
  CORREO VARCHAR(60) NOT NULL,
  DIRECCION VARCHAR(60) NOT NULL
);

CREATE TABLE ANIMAL (
  IDANIMAL INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  DESCANIMAL VARCHAR(50) DEFAULT NULL
);

SELECT * FROM Animal WHERE descanimal = 'canario';
SELECT * FROM cliente;


CREATE TABLE TIPOPRODUCTO (
  IDTIPOPRO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  DESCTIPOPRO VARCHAR(50) NOT NULL
);

CREATE TABLE PROVEEDOR (
  IDPROVEEDOR INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  TELEFONO VARCHAR(11) NOT NULL,
  DIRECCION VARCHAR(80) NOT NULL,
  EMPRESA VARCHAR(50) NOT NULL,
  RUC VARCHAR(11) NOT NULL,
  CORREO VARCHAR(60) NOT NULL,
  REPRESENTANTE VARCHAR(60) DEFAULT NULL
);

CREATE TABLE PRODUCTO (
  IDPRODUCTO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  IDTIPOPRO INT NOT NULL,
  IDPROVEEDOR INT NOT NULL,
  NOMBRE VARCHAR(120) NOT NULL,
  CANTIDAD SMALLINT NOT NULL,
  PRECIOPUBLICO DECIMAL(10,2) NOT NULL,
  STOCKMINIMO SMALLINT NOT NULL,
  STOCKMAXIMO SMALLINT NOT NULL,
  CODESTADO boolean NOT NULL,
  IDANIMAL INT NOT NULL,
  PRECIOPROVEEDOR DECIMAL(10,2) NOT NULL,
  CONSTRAINT PRODUCTO_IBFK_1 FOREIGN KEY (IDTIPOPRO) REFERENCES TIPOPRODUCTO (IDTIPOPRO),
  CONSTRAINT PRODUCTO_IBFK_2 FOREIGN KEY (IDPROVEEDOR) REFERENCES PROVEEDOR (IDPROVEEDOR),
  CONSTRAINT PRODUCTO_IBFK_3 FOREIGN KEY (IDANIMAL) REFERENCES ANIMAL (IDANIMAL),
  CONSTRAINT CODESTADOPROD_FK_4 FOREIGN KEY (CODESTADO) REFERENCES ESTADO(CODESTADO)
);

CREATE TABLE USUARIO (
   IDUSUARIO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
   NOMUSUARIO VARCHAR(100) NOT NULL,
   EMAIL VARCHAR(200) NOT NULL,
   PASSWORD VARCHAR(100) NOT NULL,
   NOMBRES VARCHAR(100) NOT NULL,
   APELLIDOS VARCHAR(100) NOT NULL,
   DNI VARCHAR(8) NOT NULL,
   TELEFONO VARCHAR(11) NOT NULL,
   DIRECCION VARCHAR(80) NOT NULL,
   CODESTADO boolean NOT NULL,
   CONSTRAINT CODESTADOUSE_FK_1 FOREIGN KEY (CODESTADO) REFERENCES ESTADO(CODESTADO)
);

CREATE TABLE ROL (
   IDROL INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
   NOMROL VARCHAR(300) NULL
);

CREATE TABLE USUARIO_ROL (
   IDUSUARIO INT NOT NULL,
   IDROL INT NOT NULL,
   CONSTRAINT USER_ROLE_PK PRIMARY KEY (IDUSUARIO, IDROL),
   CONSTRAINT USER_ROLE_FK FOREIGN KEY (IDUSUARIO) REFERENCES USUARIO(IDUSUARIO),
   CONSTRAINT USER_ROLE_FK_1 FOREIGN KEY (IDROL) REFERENCES ROL(IDROL)
);

CREATE TABLE TIPOPAGO (
  IDTIPOPAGO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  DESCRIPCION VARCHAR(45) DEFAULT NULL
);



CREATE TABLE VENTA_PRODUCTO (
  CODVENTAPRO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  IDCLIENTE INT NOT NULL,
  FECHA TIMESTAMP NOT NULL,
  DIRECCION VARCHAR(80) NOT NULL,
  MONTOTOTAL DECIMAL(10,2) NOT NULL,
  IDTIPOPAGO INT NOT NULL,
  CANTIDAD SMALLINT NOT NULL,
  CONSTRAINT FK_TIPOPAGO FOREIGN KEY (IDTIPOPAGO) REFERENCES TIPOPAGO (IDTIPOPAGO),
  CONSTRAINT FK_CLIENTE FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE (IDCLIENTE)
);

CREATE TABLE DETALLE_TIPOPAGO (
  IDDETALLEPAGO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  CODVENTAPRO INT NOT NULL,
  IDPRODUCTO INT NOT NULL,
  IDTIPOPAGO INT DEFAULT NULL,
  NUMEROCUENTA VARCHAR(45) DEFAULT NULL,
  FECHAVENCIMIENTO DATE DEFAULT NULL,
  CONSTRAINT FK_TIPOPAGOD FOREIGN KEY (IDTIPOPAGO) REFERENCES TIPOPAGO (IDTIPOPAGO),
  CONSTRAINT FK_VENTA_PRODUCTO FOREIGN KEY (CODVENTAPRO) REFERENCES VENTA_PRODUCTO (CODVENTAPRO),
  CONSTRAINT FK_PRODUCTO FOREIGN KEY (IDPRODUCTO) REFERENCES PRODUCTO (IDPRODUCTO) 
);


/*VALUES PARA USUARIOS*/
INSERT INTO ESTADO VALUES (true,"ACTIVO");
INSERT INTO ESTADO VALUES (false,"INACTIVO");

INSERT INTO ROL VALUES (1,"ROLE_ADMIN");
INSERT INTO ROL VALUES (2,"ROLE_USER");

INSERT INTO USUARIO VALUES (1,"oswaldo", "oswaldo@gmail.com", "$2a$10$7p589xu.7CY6IPaSRSaOLuOS2LIxEwMSnSi9MY2IB.q9cXnc1vTIq", "oswaldo","Santibañez",41642035,"902074125", "Calle Las alondras 149 - Bellavista Callao",  true),
							(2,"alfredo", "alfredo@gmail.com", "$2a$10$7p589xu.7CY6IPaSRSaOLuOS2LIxEwMSnSi9MY2IB.q9cXnc1vTIq", "alfredo","castillo",75345634,"987456345", "Calle A - Marquez Callao",  true),
                            (3,"julio", "julio@gmail.com", "$2a$10$7p589xu.7CY6IPaSRSaOLuOS2LIxEwMSnSi9MY2IB.q9cXnc1vTIq", "julio","moscol",75117449,"984321367", "Calle B - Mi Perú Callao",  true),
                            (4,"angelo", "angelo@gmail.com", "$2a$10$7p589xu.7CY6IPaSRSaOLuOS2LIxEwMSnSi9MY2IB.q9cXnc1vTIq", "angelo","garcia",73453456,"986543234", "Calle C - Carmen de la Legua Reynoso",  true);
INSERT INTO USUARIO_ROL VALUES(1,1);
INSERT INTO tipopago VALUES (1,'Efectivo'),(2,'Tarjeta'), (3,'Transferencia');

INSERT INTO ANIMAL VALUES (1, "Gato");
INSERT INTO ANIMAL VALUES (2, "Perro");
INSERT INTO ANIMAL VALUES (3, "Loro");
INSERT INTO ANIMAL VALUES (4, "Canario");
INSERT INTO ANIMAL VALUES (5, "Hamsters");

INSERT INTO TIPOPRODUCTO VALUES (1, "Comida");
INSERT INTO TIPOPRODUCTO VALUES (2, "Juguetes");
INSERT INTO TIPOPRODUCTO VALUES (3, "Ropa y Accesorios");
INSERT INTO TIPOPRODUCTO VALUES (4, "Limpieza");
INSERT INTO TIPOPRODUCTO VALUES (5, "Medicamentos");

INSERT INTO PROVEEDOR VALUES (1, "359-1406","Av. José Pardo 434","Rintisa","20100617332","consultas@ricocan.com","José Perez");
INSERT INTO PROVEEDOR VALUES (2, "0800-10210","Fabrica Nestle, Alberto Reyes 1808, Lima 15081","Nestlé","20100166578","elviracano@gmail.com","Elvira Cano");
INSERT INTO PROVEEDOR VALUES (3, "0800-20330", "Av. Los Olivos 1234, Arequipa 04001", "Distribuidora Sol", "20203040679", "contacto@distribuidorasol.com", "Carlos Pérez"),
(4, "0800-40560", "Calle Las Palmas 567, Lima 08002", "Purina", "20506412009", "info@purina.pe", "Juan Carlos Bodoque"),
(5, "0800-60690", "Jirón Bolívar 890, Trujillo 13001", "Aceros del Norte", "20601457389", "ventas@acerosnorte.com", "Miguel Rodríguez"),
(6, "0800-70830", "Av. Grau 345, Piura 20003", "Agroindustrias Piura", "20305467912", "info@agroindustriaspiura.com", "María Flores"),
(7, "0800-80950", "Calle San Martín 234, Ica 11001", "Constructora Andina", "20456789012", "contacto@constructoraandina.com", "José Torres"),
(8, "0800-90870", "Jirón Sucre 321, Chiclayo 14001", "Industrias del Norte", "20987654321", "contacto@industriasnorte.com", "Valeria García"),
(9, "0800-10090", "Av. Libertad 123, Tacna 23001", "Exportadora Tacna", "20212345678", "ventas@exportadoratacna.com", "Javier Medina"),
(10, "0800-11230", "Calle Pizarro 567, Huancayo 12001", "Minerales Huancayo", "20543210987", "contacto@mineraleshuancayo.com", "Claudia Ruiz");


INSERT INTO CLIENTE VALUES (1, "Moises","Rodicio","74033879","902074135","moises_rod@gmail.com","Elvira Rose 3050"),
(2, "Lucía", "Gómez", "74518293", "912345678", "lucia.gomez@gmail.com", "Av. Los Álamos 456"),
(3, "Carlos", "Pérez", "72109458", "922336789", "carlos_perez@yahoo.com", "Calle Primavera 123"),
(4, "Ana", "Fernández", "73285917", "931287654", "ana_fernandez@hotmail.com", "Jirón Sol 897"),
(5, "Javier", "Martínez", "75623841", "942986532", "javier_martinez@outlook.com", "Av. Libertad 678"),
(6, "Sofía", "Rodríguez", "76518234", "951237896", "sofia_rod@gmail.com", "Calle Luna 234"),
(7, "Miguel", "Díaz", "71234567", "961458239", "miguel.diaz@live.com", "Jirón Pizarro 321"),
(8, "Valeria", "García", "74819263", "971236485", "valeria.garcia@gmail.com", "Av. Las Flores 567"),
(9, "Diego", "Lopez", "73018294", "982475123", "diego.lopez@hotmail.com", "Calle Olmos 876"),
(10, "María", "Romero", "75410983", "992183746", "maria.romero@yahoo.com", "Jirón Bolívar 456");

INSERT INTO PRODUCTO VALUES (1,1,1,'CANBO DOG CON CORDERO RZ.MYG AD 3KG',20,51.60,5,30,1,2,38.17),(2,1,1,'CANBO DOG CON CORDERO RZ.MYG AD 15KG',10,221.80,5,20,0,1,164.14),
(3,1,1,'CANBO DOG CON CORDERO RZ.PQ AD 3KG',6,51.60,5,30,0,2,38.17),
(5,1,1,'CANBO DOG HIGH BALANCE T.RZ AD 15KG',17,221.80,5,20,1,2,164.14),
(6,1,1,'CANBO DOG CON CORDERO RZ.MYG CACH 3KG',18,56.20,5,30,0,2,41.61),
(7,1,1,'CANBO DOG CON CORDERO RZ.MYG CACH 15KG',10,232.10,5,20,0,2,171.78),
(8,1,1,'CANBO DOG CON CORDERO RZ.PQ CACH 1KG',26,20.60,5,30,0,2,15.27),
(9,1,1,'CANBO DOG CON CORDERO RZ.PQ CACH 7KG',15,117.10,5,25,0,2,86.65),
(10,1,1,'CANBO DOG CON POLLO ARROZ RZ.PQ AD 3KG',10,59.00,5,30,0,2,43.64),
(11,1,1,'CANBO DOG CON POLLO ARROZ RZ.PQ AD 7KG',15,129.00,5,25,0,2,95.20),
(12,1,1,'CANBO DOG CON POLLO ARROZ  RZ.MYG AD 3KG',10,59.00,5,30,0,2,43.64),
(13,1,1,'CANBO DOG CON POLLO ARROZ RZ.MYG AD 15KG',10,253.00,5,20,0,2,186.44),
(14,1,1,'CANBO DOG CON POLLO ARROZ T.RZ SENIOR 3KG',15,59.00,5,30,0,2,43.64),
(15,1,1,'CANBO DOG CON POLLO ARROZ T.RZ SENIOR 15KG',15,253.00,5,20,0,2,186.44),
(16,1,1,'CANBO DOG CON POLLO ARROZ RZ.PQ CACH 1KG',10,23.60,5,30,0,2,17.48),
(17,1,1,'CANBO DOG CON POLLO ARROZ RZ.PQ CACH 7KG',15,134.20,5,25,0,2,99.32),
(18,1,1,'CANBO DOG CON POLLO ARROZ RZ.MYG CACH 3KG',25,64.40,5,30,0,2,47.67),
(19,1,1,'CANBO DOG CON POLLO ARROZ RZ.MYG CACH 15KG',15,269.00,5,20,0,2,198.63),
(20,1,1,'CANBO DOG SKIN PROTECTION CON SALMON T.RZ AD 3KG',10,64.40,5,30,0,2,47.67),
(21,1,1,'CANBO DOG SKIN PROTECTION CON SALMON T.RZ AD 15KG',12,269.00,5,20,0,2,198.63),
(22,1,1,'CANBO DOG WEIGHT CONTROL CON POLLO T.RZ AD 3KG',10,64.40,5,30,0,2,47.67),
(23,1,1,'CANBO DOG WEIGHT CONTROL CON POLLO T.RZ AD 15KG',18,269.00,5,20,0,2,198.63);



insert into venta_producto values (null,1, "2023-12-01T13:47", "Av Venezuela con Av Fauccet", 51.6, 1, 1);


CREATE TABLE VENTA (
  IDVENTA INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  IDCLIENTE INT NOT NULL,
  FECHA TIMESTAMP NOT NULL,
  DIRECCION VARCHAR(80) NOT NULL,
  MONTOTOTAL DECIMAL(10,2) NOT NULL, 
  IDTIPOPAGO INT NOT NULL,
  CONSTRAINT FK_VENTA_CLIENTE FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE (IDCLIENTE),
  CONSTRAINT FK_VENTA_TIPOPAGO FOREIGN KEY (IDTIPOPAGO) REFERENCES TIPOPAGO (IDTIPOPAGO)
);

CREATE TABLE DETALLE_VENTA (
  IDDETALLE INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  IDVENTA INT NOT NULL,
  IDPRODUCTO INT NOT NULL,
  CANTIDAD SMALLINT NOT NULL,
  PRECIO DECIMAL(10,2) NOT NULL,
  CONSTRAINT FK_DETALLE_VENTA_PRODUCTO FOREIGN KEY (IDPRODUCTO) REFERENCES PRODUCTO (IDPRODUCTO),
  CONSTRAINT FK_DETALLE_VENTA FOREIGN KEY (IDVENTA) REFERENCES VENTA (IDVENTA)
);

CREATE TABLE DETALLE_PAGO (
  IDPAGO INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
  IDVENTA INT NOT NULL,
  NUMEROTARJETA VARCHAR(16) DEFAULT NULL,
  FECHAVENCIMIENTO TIMESTAMP NULL,
  CVV SMALLINT DEFAULT NULL,
  CONSTRAINT FK_DETALLE_PAGO_VENTA FOREIGN KEY (IDVENTA) REFERENCES VENTA (IDVENTA)
);

select * from cliente;